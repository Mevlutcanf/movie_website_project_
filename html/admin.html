<!DOCTYPE html>
<html lang="tr">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VisionBox</title>
    <link rel="stylesheet" href="../css/style.css">
    <link rel="shortcut icon" type="image/png" href="../icon.png">
    <script src="../js/index.js" defer></script>
    <script src="https://cdn.jsdelivr.net/npm/darkmode-js@1.5.7/lib/darkmode-js.min.js"></script>
    <!-- Font preloading ekleyelim -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="../css/admin.css">
    <!-- YouTube iframe API'sini ekleyelim -->
    <script async src="https://www.youtube.com/iframe_api"></script>
</head>

<body>
    <!-- HEADER -->
    <header>
        <h1 style="cursor: pointer;" onclick="handleLogoClick()">VisionBox</h1> <!-- 'index.html' yerine 'user.html' yapÄ±ldÄ± -->
        <form id="form">
            <input type="text" class="search" id="search" placeholder="Ä°stediÄŸiniz filmleri arayÄ±n" autocomplete="off">
        </form>
        <nav>
            <span id="user-email" style="margin-right: 10px; color: white;">ğŸ‘‹ HoÅŸgeldiniz</span>
            <a href="guest.html" style="margin-right: 10px;" id="logout-btn" onclick="handleLogout(event)">Ã‡Ä±kÄ±ÅŸ Yap</a>
        </nav>
    </header>

    <!-- MAIN CONTAINER -->
    <div class="main-container">
        <!-- Sol Taraf: TÃ¼r SeÃ§ici -->
        <aside class="genre-selector">
            <style>
            .genre-title {
                font-family: 'Poppins', sans-serif;
                color: #000000;
                font-size: 24px;
                margin-bottom: 10px;
            }
            #genre-list li {
                font-size: 18px; /* YazÄ±larÄ±n boyutunu bÃ¼yÃ¼tmek iÃ§in */
            }
            </style>
            <div style="background-color: #666363; padding: 10px; border-radius: 5px; display: inline-block;">
                <h1 class="genre-title">ğŸ¬ TÃ¼rler</h1>
            </div>
            <!-- TÃ¼rler Listesi -->
            <ul id="genre-list">
            <!-- TÃ¼rler API'den dinamik olarak yÃ¼klenecek -->
            </ul>
        </aside>

        <!-- Orta KÄ±sÄ±m: Ana Filmler -->
        <section class="movies">
            
            <div id="main" class="movie-grid">
                <!-- Filmler burada yÃ¼klenecek -->
            </div>

            <!-- Pagination -->
            <div class="pagination">
                <button id="prev-page">Ã–nceki Sayfa</button>
                <span id="current-page">Sayfa: 1</span>
                <button id="next-page">Sonraki Sayfa</button>
            </div>
        </section>

        <!-- SaÄŸ Taraf: Ã–nerilen Filmler -->
        <aside id="recommended-movies" class="recommended-movies">
            <h2 style="font-family: 'Poppins', sans-serif; color: #000000; font-size: 24px; margin-bottom: 10px; background-color: #666363; padding: 10px; border-radius: 5px; display: inline-block;">ğŸ¿ Ã–nerilen Filmler</h2>
            <div id="recommended-list">
                <!-- Burada Ã¶nerilen filmler gÃ¶sterilecek -->
            </div>
        </aside>
    </div>

    <!-- FOOTER -->
    <footer>
        <h3>VisionBox</h3>
        <ul>
            <li><a href="#">KoÅŸullar ve Gizlilik</a></li>
            <li><a href="#">Geri Bildirimde Bulunun</a></li>
            <li><a href="#">Ã‡erez PolitikasÄ±</a></li>
            <li><a href="#">YardÄ±m</a></li>
        </ul>
        <small>Â© 2024 HaklarÄ±nÄ±z SaklÄ±dÄ±r.</small>
        <small>Â© 2024 BU SÄ°TE PROJE AMAÃ‡LI MEVLÃœT FINDIK TARAFINDAN YAPILMIÅTIR.</small>
    </footer>

    <!-- DARK MODE TOGGLE -->
    
    <script>
        // Font yÃ¼kleme optimizasyonu
        if ('fonts' in document) {
            Promise.all([
                document.fonts.load('1em Poppins'),
                document.fonts.load('500 1em Poppins'),
                document.fonts.load('600 1em Poppins')
            ]).then(() => {
                document.documentElement.classList.add('fonts-loaded');
            });
        }

        // KullanÄ±cÄ± e-postasÄ±nÄ± localStorage'dan al ve gÃ¶ster
        document.addEventListener('DOMContentLoaded', () => {
            const userEmail = localStorage.getItem('userEmail');
            const userEmailElement = document.getElementById('user-email');
            
            if (userEmail && userEmailElement) {
                userEmailElement.textContent = `ğŸ‘‹ HoÅŸgeldin, ${userEmail.split('@')[0]}`; // Sadece @ iÅŸaretinden Ã¶nceki kÄ±smÄ± gÃ¶ster
            }
            
            // Ã‡Ä±kÄ±ÅŸ yap butonuna tÄ±klandÄ±ÄŸÄ±nda
            const logoutBtn = document.getElementById('logout-btn');
            if (logoutBtn) {
                logoutBtn.addEventListener('click', handleLogout);
            }
        });

        // Dark mode ayarlarÄ±
        const options = {
            bottom: '64px',
            right: '32px',
            time: '0.5s',
            mixColor: '#c9d6ff',
            backgroundColor: '#333',
            buttonColorDark: '#100f2c',
            buttonColorLight: '#fff',
            saveInCookies: true,
            label: 'ğŸŒ“',
            autoMatchOsTheme: false
        };
        
        const darkmode = new Darkmode(options);
        darkmode.showWidget();

        // Ã‡Ä±kÄ±ÅŸ yapma iÅŸlemi iÃ§in yeni fonksiyon
        function handleLogout(event) {
            event.preventDefault();
            const confirmLogout = confirm('Ã‡Ä±kÄ±ÅŸ yapmak istediÄŸinize emin misiniz?');
            if (confirmLogout) {
                localStorage.removeItem('userEmail');
                window.location.href = 'index.html';
            }
        }

        // KullanÄ±cÄ± durumu kontrolÃ¼
        document.addEventListener('DOMContentLoaded', () => {
            const userEmail = localStorage.getItem('userEmail');
            if (!userEmail) {
                // EÄŸer kullanÄ±cÄ± giriÅŸi yoksa login sayfasÄ±na yÃ¶nlendir
                window.location.href = 'login.html';
            } else {
                const userEmailElement = document.getElementById('user-email');
                if (userEmailElement) {
                    userEmailElement.textContent = `ğŸ‘‹ HoÅŸgeldin, ${userEmail.split('@')[0]}`;
                }
            }
        });

        // Logo tÄ±klama iÅŸleyicisi
        function handleLogoClick() {
            const userEmail = localStorage.getItem('userEmail');
            if (userEmail) {
                window.location.href = 'user.html';
            } else {
                window.location.href = 'index.html';
            }
        }
    </script>
</body>

</html>
